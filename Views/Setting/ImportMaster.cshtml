

@{
    ViewBag.Title = "Import Master (Supplier, Customer & Employee)";
}

@section Styles{
    <style>
        .table thead tr th, .table tbody tr td {
            font-size: 11px;
            padding: 0px 1px;
        }
    </style>
}


<div class="clearfix" id="viewarea" ng-app="UploadFile">
    <fieldset class="pb-3" ng-controller="SupplierImportController">
        <legend>Upload Supplier Excel File  <a href="~/Assets/Format/supplier.xlsx" class="text-warning"> <i class="fa fa-file-excel-o"></i> Format</a></legend>
        <div class="form-inline">
            <input type="file" class="form-control" name="file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" onchange="angular.element(this).scope().PrepareThisFile(this.files)" />

            <button type="button" value="Preview" class="btn btn-primary ml-1" ng-disabled="!SelectedFileForUpload" ng-click="ParseExcel() ">
                <span ng-show="showLoader" class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span> Preview
            </button>
            <button type="button" value="Insert" class="btn btn-success ml-1" ng-show="ShowPermission" ng-click="InsertData()">
                <span ng-show="Showloaderf" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Insert
            </button>
            <span style="color:red">
                {{Message}}
            </span>
        </div>
        <table class="table table-bordered table-responsive" ng-show="ShowPermission" id="supplierDataTable" width="100%">
            <thead>
                <tr>
                    <th>Sl</th>
                    <th>Company Name</th>
                    <th>Code</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Job Title</th>
                    <th>Business Phone</th>
                    <th>Mobile Number</th>
                    <th>National Id</th>
                    <th>Tin Number</th>
                    <th>Fax Number</th>
                    <th>Country</th>
                    <th>State</th>
                    <th>City</th>
                    <th>Address</th>
                    <th>Zip /Postal Code</th>
                    <th>Email </th>
                    <th>Website</th>
                    <th>Notes</th>
                </tr>
            </thead>

        </table>
        <ul class="mt-3">
            <li> *** Code Number must be a integer number & Unique</li>
            <li> *** National must be Unique                      </li>
            <li> *** National Business Phone                      </li>
            <li> ** Company Name Should not Empty                  </li>
            <li> ** After Succesfull Insert Pleae Check Missing Ledger </li>
        </ul>
    </fieldset>

    <fieldset class="pb-3" ng-controller="CustomerImportController">
        <legend>Upload Customer Excel File   <a href="~/Assets/Format/Customer.xlsx" class="text-warning"> <i class="fa fa-file-excel-o"></i> Format</a></legend>
        <div class="form-inline">
            <input type="file" class="form-control" name="file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" onchange="angular.element(this).scope().PrepareThisFile(this.files)" />

            <button type="button" value="Preview" class="btn btn-primary ml-1" ng-disabled="!SelectedFileForUpload" ng-click="ParseExcel() ">
                <span ng-show="showLoader" class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span> Preview
            </button>
            <button type="button" value="Insert" class="btn btn-success ml-1" ng-show="ShowPermission" ng-click="InsertData()">
                <span ng-show="Showloaderf" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Insert
            </button>

            <span style="color:red">
                {{Message}}
            </span>


        </div>



        <table class="table table-bordered table-responsive" ng-show="ShowPermission" id="customerDataTable" width="100%">
            <thead>
                <tr>
                    <th>Sl</th>
                    <th>Company Name</th>
                    <th>Code</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Balance Limit</th>
                    <th>Phone</th>
                    <th>Website</th>
                    <th>Email </th>
                    <th>Tin Number</th>
                    <th>Country</th>
                    <th>State</th>
                    <th>City</th>
                    <th>Address</th>
                    <th>National Id</th>
                </tr>
            </thead>
        </table>
        <ul class="mt-3">
            <li> *** Code Number must be a integer number & Unique</li>
            <li> *** National Id must be Unique                      </li>
            <li> *** Phone Number                      </li>
            <li> ** Company Name Should not Empty                  </li>
            <li> ** After Succesfull Insert Pleae Check Missing Ledger </li>
            <li> ** Is single person Fillout Company Name with his/her Name </li>
        </ul>
    </fieldset>

    <fieldset class="pb-3" ng-controller="EmpoloyeeImportController">
        <legend>Upload Employee Excel File  <a href="~/Assets/Format/Employee.xlsx" class="text-warning"><i class="fa fa-file-excel-o"></i> Fomat</a> </legend>
        <div class="form-inline">
            <input type="file" class="form-control" name="file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" onchange="angular.element(this).scope().PrepareThisFile(this.files)" />

            <button type="button" value="Preview" class="btn btn-primary ml-1" ng-disabled="!SelectedFileForUpload" ng-click="ParseExcel() ">
                <span ng-show="showLoader" class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span> Preview
            </button>
            <button type="button" value="Insert" class="btn btn-success ml-1" ng-show="ShowPermission" ng-click="InsertData()">
                <span ng-show="Showloaderf" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Insert
            </button>
            <span style="color:red">
                {{Message}}
            </span>
        </div>
        <table class="table table-bordered" ng-show="ShowPermission" id="EmployeeDataTable" width="100%">
            <thead>
                <tr>
                    <th>Sl</th>
                    <th>First Name</th>
                    <th>last Name</th>
                    <th>Job Title</th>
                    <th>DoB</th>
                    <th>Joining Date</th>
                    <th>Gender</th>
                    <th>Blood Group</th>
                    <th>Home Phone</th>
                    <th>Bussiness Phone</th>
                    <th>Country</th>
                    <th>State/Provinence</th>
                    <th>City</th>
                    <th>Address</th>
                    <th>Zip /Postal Code</th>
                    <th>NationalId</th>
                    <th>TinNumber</th>
                    <th>Code</th>
                    <th>Email </th>
                    <th>Notes</th>

                </tr>
            </thead>
        </table>

    </fieldset>


    <fieldset class="pb-3" ng-controller="SearchLedgerController">
        <legend> Check Missing Ledger & Generate</legend>
        <div class="col-md-3 offset-md-4">
            <select id="LedgerType" class="form-control" onchange="angular.element(this).scope().LoadMissingLedger(this.value)">
                <option value="">-Select Group--</option>
                <option value="Supplier">Supplier</option>
                <option value="Customer">Customer</option>
                <option value="Employee">Employee</option>
            </select>
        </div>
        <div class="col-md-6 offset-md-3">
            <label ng-show="isVisible">  <input type="checkbox" class="checkbox" onchange="angular.element(this).scope().checkAlll(true)" id="checkAlll" />   Select All </label>

            <br />
            <ul class="searchResult">
            </ul>
            <span class="text-info"> {{Message}}</span>
            <div class="col-sm-3 offset-sm-4 mt-2 pb-2">
                <button type="button" value="Create Ledger" ng-disabled="isloading" class="btn btn-sm btn-outline-danger" ng-click="CreateMissingLedger()" ng-show="isVisible">  <span ng-show="ShowLoader8" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Create Ledger</button>
            </div>
        </div>
    </fieldset>
</div>

@section scripts{
    <script src="~/Assets/js/AngularFunctions.js"></script>
}




